// cpuconst.h


extern int64_t *n43_h;


/////////////////////////////
// main lock for search data
extern uint32_t current_n43;
extern pthread_mutex_t lock1;
/////////////////////////////


///////////////////////////////////
// lock used for reporting results
extern pthread_mutex_t lock2;
///////////////////////////////////


typedef struct _thread_data_t {
	int id;
	int K;
	int SHIFT;
	int64_t STEP, S43, S47, S53, S59;
} thread_data_t;


// located in AP26.cpp
extern void Progress(double prog);
extern void ReportSolution(int AP_Length,int difference,int64_t First_Term);
extern int PrimeQ(int64_t N);
extern int boinc_standalone(void);


#define thread_range 50
#define numn43s	10840

#define PRIM23 INT64_C(223092870)
#define PRIME1 29
#define PRIME2 31
#define PRIME3 37
#define PRIME4 41
#define PRIME5 43
#define PRIME6 47
#define PRIME7 53
#define PRIME8 59
#define MOD  INT64_C(258559632607830)
#define N0  INT64_C(106990415896110)
#define N30  INT64_C(94805198622871)
#define S3 INT64_C(172373088405220)
#define S5 INT64_C(51711926521566)
#define PRES2 INT64_C(16681266619860)
#define PRES3 INT64_C(181690552643340)
#define PRES4 INT64_C(132432982555230)
#define PRES5 INT64_C(126273308948010)
#define PRES6 INT64_C(115526644356690)
#define PRES7 INT64_C(48784836341100)
#define PRES8 INT64_C(100794433050510)

/* These constants were generated with the PARI/GP command:
     forprime(p=61,331,print("#define INV",p," UINT64_C(",2^64\p,")"))
*/
#define INV61 UINT64_C(302405640552615600)
#define INV67 UINT64_C(275324538413575397)
#define INV71 UINT64_C(259813296812810586)
#define INV73 UINT64_C(252695124297391118)
#define INV79 UINT64_C(233503089540627235)
#define INV83 UINT64_C(222249928598910260)
#define INV89 UINT64_C(207266787345051141)
#define INV97 UINT64_C(190172619316593315)
#define INV101 UINT64_C(182641030432767837)
#define INV103 UINT64_C(179094602657374287)
#define INV107 UINT64_C(172399477324388332)
#define INV109 UINT64_C(169236184162472950)
#define INV113 UINT64_C(163245522776190722)
#define INV127 UINT64_C(145249953336295682)
#define INV131 UINT64_C(140814840257324821)
#define INV137 UINT64_C(134647766961383588)
#define INV139 UINT64_C(132710389019493177)
#define INV149 UINT64_C(123803651501406386)
#define INV151 UINT64_C(122163868037811600)
#define INV157 UINT64_C(117495185182863386)
#define INV163 UINT64_C(113170209041162893)
#define INV167 UINT64_C(110459545351554201)
#define INV173 UINT64_C(106628578460748853)
#define INV179 UINT64_C(103054436165975148)
#define INV181 UINT64_C(101915713114417412)
#define INV191 UINT64_C(96579811904238490)
#define INV193 UINT64_C(95578984837873324)
#define INV197 UINT64_C(93638294790403815)
#define INV199 UINT64_C(92697206400550510)
#define INV211 UINT64_C(87425327363552377)
#define INV223 UINT64_C(82720825442643729)
#define INV227 UINT64_C(81263189752024456)
#define INV229 UINT64_C(80553467570784068)
#define INV233 UINT64_C(79170575423646144)
#define INV239 UINT64_C(77183029597111094)
#define INV241 UINT64_C(76542506529915151)
#define INV251 UINT64_C(73493004277727297)
#define INV257 UINT64_C(71777214294589695)
#define INV263 UINT64_C(70139711306880424)
#define INV269 UINT64_C(68575256779589411)
#define INV271 UINT64_C(68069166323651481)
#define INV277 UINT64_C(66594743948409933)


/* evaluates to (N%P), assuming N < 2^(64-S), P < 2^S.
*/
#define REM(_N,_P,_S) \
  (UINT32_C(_P)*(uint32_t)(((INV##_P*((uint64_t)(_N)+1))>>(32+_S))))>>(32-_S)


